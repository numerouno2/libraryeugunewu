-- UILibrary.lua
-- Simpan di GitHub Gist atau pastebin, lalu loadstring

local UILib = {}
UILib.__index = UILib

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local VirtualUser = game:GetService("VirtualUser")

--=============================================
-- ANTI-AFK SYSTEM (ALWAYS ON)
--=============================================
local AntiAFK = {
    Enabled = true,
    Connection = nil
}

function AntiAFK:Enable()
    if self.Connection then return end -- Already enabled
    
    -- Prevent idle kick
    self.Connection = game:GetService("Players").LocalPlayer.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
    
    -- Additional heartbeat method for extra safety
    self.HeartbeatConnection = game:GetService("RunService").Heartbeat:Connect(function()
        pcall(function()
            VirtualUser:CaptureController()
            VirtualUser:Button1Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
        end)
    end)
    
    print("[Anti-AFK] Always Active - You won't be kicked for inactivity")
end

-- Auto-start Anti-AFK immediately
AntiAFK:Enable()

--=============================================
-- FUNGSI UTAMA: Buat Window
--=============================================
function UILib.new(config)
    local self = setmetatable({}, UILib)
    
    self.Title = config.Title or "My Hub"
    self.Size = config.Size or UDim2.new(0, 700, 0, 500)
    self.Tabs = {}
    self.TabButtons = {}
    self.TabPages = {}
    self.ActiveTab = nil
    self.UpdateCallbacks = {}
    self.AntiAFK = AntiAFK
    
    -- Anti-AFK is always active (no config needed)
    
    -- Hapus GUI lama
    local oldGui = game.CoreGui:FindFirstChild("UILib_Main")
    if oldGui then oldGui:Destroy() end
    
    -- ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "UILib_Main"
    self.ScreenGui.Parent = game.CoreGui
    self.ScreenGui.ResetOnSpawn = false
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Shadow
    self.Shadow = Instance.new("ImageLabel", self.ScreenGui)
    self.Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    self.Shadow.BackgroundTransparency = 1
    self.Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    self.Shadow.Size = self.Size + UDim2.new(0, 40, 0, 40)
    self.Shadow.Image = "rbxassetid://5554236805"
    self.Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    self.Shadow.ImageTransparency = 0.6
    self.Shadow.ScaleType = Enum.ScaleType.Slice
    self.Shadow.SliceCenter = Rect.new(23, 23, 277, 277)
    
    -- Main Frame
    self.Main = Instance.new("Frame", self.ScreenGui)
    self.Main.Name = "Main"
    self.Main.AnchorPoint = Vector2.new(0.5, 0.5)
    self.Main.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
    self.Main.BorderSizePixel = 0
    self.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    self.Main.Size = self.Size
    self.Main.ClipsDescendants = true
    Instance.new("UICorner", self.Main).CornerRadius = UDim.new(0, 12)
    
    local stroke = Instance.new("UIStroke", self.Main)
    stroke.Color = Color3.fromRGB(60, 80, 180)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.5
    
    -- Dragging
    self:_setupDrag()
    
    -- Animated top bar line
    self:_createAnimatedBar()
    
    -- Title Bar
    self:_createTitleBar()
    
    -- Sidebar
    self:_createSidebar()
    
    -- Content Area
    self.ContentArea = Instance.new("Frame", self.Main)
    self.ContentArea.BackgroundColor3 = Color3.fromRGB(22, 22, 30)
    self.ContentArea.BorderSizePixel = 0
    self.ContentArea.Position = UDim2.new(0, 160, 0, 53)
    self.ContentArea.Size = UDim2.new(1, -160, 1, -53)
    
    -- Notification Bar
    self:_createNotifyBar()
    
    -- Status Labels (header area)
    self.StatusLabels = {}
    self:_createStatusArea()
    
    -- Open animation
    self.Main.Size = UDim2.new(0, 0, 0, 0)
    self.Shadow.ImageTransparency = 1
    TweenService:Create(self.Main, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = self.Size
    }):Play()
    TweenService:Create(self.Shadow, TweenInfo.new(0.5), {
        ImageTransparency = 0.6
    }):Play()
    
    -- Start update loop
    self:_startUpdateLoop()
    
    return self
end

--=============================================
-- INTERNAL: Drag System
--=============================================
function UILib:_setupDrag()
    local dragging, dragInput, dragStart, startPos
    
    self.Main.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = self.Main.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    self.Main.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement 
        or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            local newPos = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
            self.Main.Position = newPos
            self.Shadow.Position = newPos
        end
    end)
end

--=============================================
-- INTERNAL: Animated Rainbow Bar
--=============================================
function UILib:_createAnimatedBar()
    local bar = Instance.new("Frame", self.Main)
    bar.BackgroundColor3 = Color3.new(1, 1, 1)
    bar.BorderSizePixel = 0
    bar.Size = UDim2.new(1, 0, 0, 3)
    
    local gradient = Instance.new("UIGradient", bar)
    gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 120, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(160, 100, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 100, 180))
    }
    
    task.spawn(function()
        while self.ScreenGui and self.ScreenGui.Parent do
            for i = 0, 1, 0.01 do
                if not self.ScreenGui.Parent then return end
                gradient.Offset = Vector2.new(i, 0)
                task.wait(0.05)
            end
            for i = 1, 0, -0.01 do
                if not self.ScreenGui.Parent then return end
                gradient.Offset = Vector2.new(i, 0)
                task.wait(0.05)
            end
        end
    end)
end

--=============================================
-- INTERNAL: Title Bar + Close/Minimize
--=============================================
function UILib:_createTitleBar()
    self.TitleBar = Instance.new("Frame", self.Main)
    self.TitleBar.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
    self.TitleBar.BorderSizePixel = 0
    self.TitleBar.Position = UDim2.new(0, 0, 0, 3)
    self.TitleBar.Size = UDim2.new(1, 0, 0, 50)
    
    -- Title Text
    local titleLabel = Instance.new("TextLabel", self.TitleBar)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Position = UDim2.new(0, 15, 0, 0)
    titleLabel.Size = UDim2.new(0, 250, 1, 0)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = self.Title
    titleLabel.TextColor3 = Color3.fromRGB(220, 220, 240)
    titleLabel.TextSize = 18
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Close Button
    local closeBtn = Instance.new("TextButton", self.TitleBar)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
    closeBtn.BackgroundTransparency = 0.8
    closeBtn.BorderSizePixel = 0
    closeBtn.Position = UDim2.new(1, -40, 0, 10)
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Text = "âœ•"
    closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
    closeBtn.TextSize = 14
    Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 8)
    
    closeBtn.MouseEnter:Connect(function()
        TweenService:Create(closeBtn, TweenInfo.new(0.2), {
            BackgroundTransparency = 0,
            TextColor3 = Color3.new(1, 1, 1)
        }):Play()
    end)
    closeBtn.MouseLeave:Connect(function()
        TweenService:Create(closeBtn, TweenInfo.new(0.2), {
            BackgroundTransparency = 0.8,
            TextColor3 = Color3.fromRGB(255, 100, 100)
        }):Play()
    end)
    closeBtn.MouseButton1Click:Connect(function()
        self.ScreenGui.Enabled = false
    end)
    
    -- Minimize Button
    local minBtn = Instance.new("TextButton", self.TitleBar)
    minBtn.BackgroundColor3 = Color3.fromRGB(255, 200, 60)
    minBtn.BackgroundTransparency = 0.8
    minBtn.BorderSizePixel = 0
    minBtn.Position = UDim2.new(1, -75, 0, 10)
    minBtn.Size = UDim2.new(0, 30, 0, 30)
    minBtn.Font = Enum.Font.GothamBold
    minBtn.Text = "â€”"
    minBtn.TextColor3 = Color3.fromRGB(255, 200, 60)
    minBtn.TextSize = 14
    Instance.new("UICorner", minBtn).CornerRadius = UDim.new(0, 8)
    
    local minimized = false
    minBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            TweenService:Create(self.Main, TweenInfo.new(0.3, Enum.EasingStyle.Quart), {
                Size = UDim2.new(0, self.Size.X.Offset, 0, 53)
            }):Play()
            TweenService:Create(self.Shadow, TweenInfo.new(0.3), {
                Size = UDim2.new(0, self.Size.X.Offset + 40, 0, 93)
            }):Play()
        else
            TweenService:Create(self.Main, TweenInfo.new(0.3, Enum.EasingStyle.Quart), {
                Size = self.Size
            }):Play()
            TweenService:Create(self.Shadow, TweenInfo.new(0.3), {
                Size = self.Size + UDim2.new(0, 40, 0, 40)
            }):Play()
        end
    end)
end

--=============================================
-- INTERNAL: Status Area (3 lines in header)
--=============================================
function UILib:_createStatusArea()
    local statusFrame = Instance.new("Frame", self.TitleBar)
    statusFrame.BackgroundTransparency = 1
    statusFrame.Position = UDim2.new(0, 260, 0, 0)
    statusFrame.Size = UDim2.new(0, 240, 1, 0)
    
    for i = 1, 3 do
        local label = Instance.new("TextLabel", statusFrame)
        label.BackgroundTransparency = 1
        label.Position = UDim2.new(0, 0, 0, 3 + (i-1) * 15)
        label.Size = UDim2.new(1, 0, 0, 15)
        label.Font = Enum.Font.GothamSemibold
        label.TextSize = 10
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.TextColor3 = Color3.fromRGB(180, 180, 200)
        label.Text = ""
        self.StatusLabels[i] = label
    end
end

--=============================================
-- PUBLIC: Update Status Lines
--=============================================
function UILib:SetStatus(line, text, color)
    if self.StatusLabels[line] then
        self.StatusLabels[line].Text = text
        if color then
            self.StatusLabels[line].TextColor3 = color
        end
    end
end

--=============================================
-- INTERNAL: Sidebar
--=============================================
function UILib:_createSidebar()
    self.Sidebar = Instance.new("Frame", self.Main)
    self.Sidebar.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
    self.Sidebar.BorderSizePixel = 0
    self.Sidebar.Position = UDim2.new(0, 0, 0, 53)
    self.Sidebar.Size = UDim2.new(0, 160, 1, -53)
    
    -- Divider line
    local line = Instance.new("Frame", self.Sidebar)
    line.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    line.BorderSizePixel = 0
    line.Position = UDim2.new(1, -1, 0, 0)
    line.Size = UDim2.new(0, 1, 1, 0)
    
    self._tabIndex = 0
end

--=============================================
-- INTERNAL: Notification Bar
--=============================================
function UILib:_createNotifyBar()
    self.NotifyBar = Instance.new("TextLabel", self.Main)
    self.NotifyBar.BackgroundColor3 = Color3.fromRGB(30, 80, 30)
    self.NotifyBar.BackgroundTransparency = 1
    self.NotifyBar.Position = UDim2.new(0, 165, 1, -30)
    self.NotifyBar.Size = UDim2.new(1, -170, 0, 25)
    self.NotifyBar.Font = Enum.Font.GothamSemibold
    self.NotifyBar.Text = ""
    self.NotifyBar.TextColor3 = Color3.fromRGB(80, 255, 120)
    self.NotifyBar.TextSize = 11
    self.NotifyBar.TextXAlignment = Enum.TextXAlignment.Left
    self.NotifyBar.TextTransparency = 1
    Instance.new("UICorner", self.NotifyBar).CornerRadius = UDim.new(0, 6)
    
    self._notifyDebounce = false
end

--=============================================
-- PUBLIC: Show Notification
--=============================================
function UILib:Notify(msg, color)
    if self._notifyDebounce then return end
    self._notifyDebounce = true
    
    self.NotifyBar.Text = "  " .. msg
    self.NotifyBar.TextColor3 = color or Color3.fromRGB(80, 255, 120)
    self.NotifyBar.TextTransparency = 0
    self.NotifyBar.BackgroundTransparency = 0.5
    
    task.delay(2, function()
        if self.NotifyBar and self.NotifyBar.Parent then
            TweenService:Create(self.NotifyBar, TweenInfo.new(0.5), {
                TextTransparency = 1,
                BackgroundTransparency = 1
            }):Play()
        end
        self._notifyDebounce = false
    end)
end

--=============================================
-- PUBLIC: Add Tab
--=============================================
function UILib:AddTab(config)
    local tabName = config.Name or "Tab"
    local tabIcon = config.Icon or "ðŸ“"
    
    self._tabIndex = self._tabIndex + 1
    local index = self._tabIndex
    
    -- Tab Button (sidebar)
    local btn = Instance.new("TextButton", self.Sidebar)
    btn.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
    btn.BorderSizePixel = 0
    btn.Position = UDim2.new(0, 8, 0, 10 + (index - 1) * 45)
    btn.Size = UDim2.new(1, -16, 0, 38)
    btn.Text = ""
    btn.AutoButtonColor = false
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    local indicator = Instance.new("Frame", btn)
    indicator.Name = "Indicator"
    indicator.BackgroundColor3 = Color3.fromRGB(100, 140, 255)
    indicator.BackgroundTransparency = 1
    indicator.BorderSizePixel = 0
    indicator.Position = UDim2.new(0, 0, 0.15, 0)
    indicator.Size = UDim2.new(0, 3, 0.7, 0)
    Instance.new("UICorner", indicator).CornerRadius = UDim.new(0, 2)
    
    local label = Instance.new("TextLabel", btn)
    label.Name = "Label"
    label.BackgroundTransparency = 1
    label.Position = UDim2.new(0, 12, 0, 0)
    label.Size = UDim2.new(1, -12, 1, 0)
    label.Font = Enum.Font.GothamBold
    label.Text = tabIcon .. "  " .. tabName
    label.TextColor3 = Color3.fromRGB(120, 120, 140)
    label.TextSize = 13
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Tab Page (scroll frame)
    local page = Instance.new("ScrollingFrame", self.ContentArea)
    page.BackgroundTransparency = 1
    page.BorderSizePixel = 0
    page.Position = UDim2.new(0, 15, 0, 10)
    page.Size = UDim2.new(1, -30, 1, -20)
    page.ScrollBarThickness = 4
    page.ScrollBarImageColor3 = Color3.fromRGB(60, 80, 180)
    page.CanvasSize = UDim2.new(0, 0, 0, 0)
    page.Visible = false
    page.AutomaticCanvasSize = Enum.AutomaticSize.Y
    
    Instance.new("UIPadding", page).PaddingRight = UDim.new(0, 8)
    local layout = Instance.new("UIListLayout", page)
    layout.Padding = UDim.new(0, 12)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    
    self.TabButtons[tabName] = btn
    self.TabPages[tabName] = page
    
    -- Click handler
    btn.MouseButton1Click:Connect(function()
        self:SwitchTab(tabName)
    end)
    
    -- Auto-select first tab
    if index == 1 then
        task.defer(function()
            self:SwitchTab(tabName)
        end)
    end
    
    -- Return a Tab object with methods
    local tab = {
        Name = tabName,
        Page = page,
        Library = self,
        _sectionOrder = 0
    }
    setmetatable(tab, {__index = UILib._TabMethods})
    
    table.insert(self.Tabs, tab)
    return tab
end

--=============================================
-- PUBLIC: Switch Tab
--=============================================
function UILib:SwitchTab(name)
    if self.ActiveTab == name then return end
    self.ActiveTab = name
    
    for tabName, btn in pairs(self.TabButtons) do
        local ind = btn:FindFirstChild("Indicator")
        local lbl = btn:FindFirstChild("Label")
        
        if tabName == name then
            btn.BackgroundColor3 = Color3.fromRGB(60, 80, 180)
            if lbl then lbl.TextColor3 = Color3.new(1, 1, 1) end
            if ind then ind.BackgroundTransparency = 0 end
        else
            btn.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
            if lbl then lbl.TextColor3 = Color3.fromRGB(120, 120, 140) end
            if ind then ind.BackgroundTransparency = 1 end
        end
    end
    
    for tabName, page in pairs(self.TabPages) do
        page.Visible = (tabName == name)
    end
end

--=============================================
-- PUBLIC: Register Update Callback
--=============================================
function UILib:OnUpdate(callback)
    table.insert(self.UpdateCallbacks, callback)
end

--=============================================
-- INTERNAL: Update Loop
--=============================================
function UILib:_startUpdateLoop()
    task.spawn(function()
        while self.ScreenGui and self.ScreenGui.Parent do
            for _, cb in ipairs(self.UpdateCallbacks) do
                pcall(cb)
            end
            task.wait(0.5)
        end
    end)
end

--=============================================
-- PUBLIC: Create Toggle Button (floating)
--=============================================
function UILib:CreateToggleButton(config)
    config = config or {}
    local icon = config.Icon or "ðŸŒ¾"
    
    local old = game.CoreGui:FindFirstChild("UILib_Toggle")
    if old then old:Destroy() end
    
    local toggleGui = Instance.new("ScreenGui")
    toggleGui.Name = "UILib_Toggle"
    toggleGui.Parent = game.CoreGui
    toggleGui.ResetOnSpawn = false
    
    local toggleBtn = Instance.new("TextButton", toggleGui)
    toggleBtn.AnchorPoint = Vector2.new(0.5, 0.5)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(60, 80, 180)
    toggleBtn.BorderSizePixel = 0
    toggleBtn.Position = UDim2.new(0, 45, 0.5, 0)
    toggleBtn.Size = UDim2.new(0, 50, 0, 50)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.Text = icon
    toggleBtn.TextSize = 24
    toggleBtn.Active = true
    toggleBtn.Draggable = true
    Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)
    
    local stroke = Instance.new("UIStroke", toggleBtn)
    stroke.Color = Color3.fromRGB(100, 140, 255)
    stroke.Thickness = 2
    
    -- Pulse animation
    task.spawn(function()
        while toggleGui and toggleGui.Parent do
            stroke.Transparency = 0.8
            task.wait(1.5)
            stroke.Transparency = 0
            task.wait(1.5)
        end
    end)
    
    toggleBtn.MouseButton1Click:Connect(function()
        self.ScreenGui.Enabled = not self.ScreenGui.Enabled
    end)
    
    return toggleGui
end

--=============================================
-- PUBLIC: Destroy
--=============================================
function UILib:Destroy()
    if self.ScreenGui then self.ScreenGui:Destroy() end
    local toggle = game.CoreGui:FindFirstChild("UILib_Toggle")
    if toggle then toggle:Destroy() end
end

--=============================================
-- TAB METHODS (elements you add to tabs)
--=============================================
UILib._TabMethods = {}

-- Add Section
function UILib._TabMethods:AddSection(config)
    self._sectionOrder = self._sectionOrder + 1
    local title = config.Title or "Section"
    local order = config.Order or self._sectionOrder
    
    local section = Instance.new("Frame", self.Page)
    section.BackgroundColor3 = Color3.fromRGB(28, 28, 38)
    section.BorderSizePixel = 0
    section.Size = UDim2.new(1, 0, 0, 0)
    section.AutomaticSize = Enum.AutomaticSize.Y
    section.LayoutOrder = order
    Instance.new("UICorner", section).CornerRadius = UDim.new(0, 10)
    
    local stroke = Instance.new("UIStroke", section)
    stroke.Color = Color3.fromRGB(45, 45, 60)
    stroke.Thickness = 1
    stroke.Transparency = 0.5
    
    local padding = Instance.new("UIPadding", section)
    padding.PaddingLeft = UDim.new(0, 15)
    padding.PaddingRight = UDim.new(0, 15)
    padding.PaddingTop = UDim.new(0, 12)
    padding.PaddingBottom = UDim.new(0, 15)
    
    local layout = Instance.new("UIListLayout", section)
    layout.Padding = UDim.new(0, 10)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    
    -- Section Title
    local titleLabel = Instance.new("TextLabel", section)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Size = UDim2.new(1, 0, 0, 22)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(200, 200, 220)
    titleLabel.TextSize = 15
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.LayoutOrder = 0
    
    -- Return section object with methods
    local sec = {
        Frame = section,
        Tab = self,
        Library = self.Library,
        _elementOrder = 0
    }
    setmetatable(sec, {__index = UILib._SectionMethods})
    return sec
end

-- Add Note (directly to tab)
function UILib._TabMethods:AddNote(config)
    self._sectionOrder = self._sectionOrder + 1
    local text = config.Text or ""
    local order = config.Order or self._sectionOrder
    
    local noteFrame = Instance.new("Frame", self.Page)
    noteFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    noteFrame.BorderSizePixel = 0
    noteFrame.Size = UDim2.new(1, 0, 0, 0)
    noteFrame.AutomaticSize = Enum.AutomaticSize.Y
    noteFrame.LayoutOrder = order
    Instance.new("UICorner", noteFrame).CornerRadius = UDim.new(0, 8)
    
    local noteText = Instance.new("TextLabel", noteFrame)
    noteText.BackgroundTransparency = 1
    noteText.Size = UDim2.new(1, -20, 0, 0)
    noteText.AutomaticSize = Enum.AutomaticSize.Y
    noteText.Position = UDim2.new(0, 10, 0, 8)
    noteText.Font = Enum.Font.Gotham
    noteText.Text = text
    noteText.TextColor3 = Color3.fromRGB(150, 180, 255)
    noteText.TextSize = 11
    noteText.TextWrapped = true
    noteText.TextXAlignment = Enum.TextXAlignment.Left
    
    Instance.new("UIPadding", noteFrame).PaddingBottom = UDim.new(0, 10)
    
    return noteText -- so you can update text
end

--=============================================
-- SECTION METHODS (elements inside sections)
--=============================================
UILib._SectionMethods = {}

-- Add Toggle
function UILib._SectionMethods:AddToggle(config)
    self._elementOrder = self._elementOrder + 1
    local text = config.Text or "Toggle"
    local default = config.Default or false
    local callback = config.Callback or function() end
    local order = config.Order or self._elementOrder
    
    local frame = Instance.new("Frame", self.Frame)
    frame.BackgroundColor3 = Color3.fromRGB(35, 35, 48)
    frame.BorderSizePixel = 0
    frame.Size = UDim2.new(1, 0, 0, 40)
    frame.LayoutOrder = order
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel", frame)
    label.BackgroundTransparency = 1
    label.Position = UDim2.new(0, 15, 0, 0)
    label.Size = UDim2.new(1, -75, 1, 0)
    label.Font = Enum.Font.GothamSemibold
    label.Text = text
    label.TextColor3 = Color3.fromRGB(180, 180, 200)
    label.TextSize = 13
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    local bg = Instance.new("Frame", frame)
    bg.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
    bg.BorderSizePixel = 0
    bg.Position = UDim2.new(1, -55, 0.5, -12)
    bg.Size = UDim2.new(0, 44, 0, 24)
    Instance.new("UICorner", bg).CornerRadius = UDim.new(1, 0)
    
    local knob = Instance.new("Frame", bg)
    knob.BackgroundColor3 = Color3.fromRGB(150, 150, 170)
    knob.BorderSizePixel = 0
    knob.Position = UDim2.new(0, 3, 0.5, -9)
    knob.Size = UDim2.new(0, 18, 0, 18)
    Instance.new("UICorner", knob).CornerRadius = UDim.new(1, 0)
    
    local active = default
    
    local function updateVisual()
        if active then
            bg.BackgroundColor3 = Color3.fromRGB(60, 160, 100)
            knob.Position = UDim2.new(1, -21, 0.5, -9)
            knob.BackgroundColor3 = Color3.new(1, 1, 1)
        else
            bg.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
            knob.Position = UDim2.new(0, 3, 0.5, -9)
            knob.BackgroundColor3 = Color3.fromRGB(150, 150, 170)
        end
    end
    
    local clickBtn = Instance.new("TextButton", frame)
    clickBtn.BackgroundTransparency = 1
    clickBtn.Size = UDim2.new(1, 0, 1, 0)
    clickBtn.Text = ""
    
    clickBtn.MouseButton1Click:Connect(function()
        active = not active
        updateVisual()
        callback(active)
    end)
    
    if active then updateVisual() end
    
    -- Return toggle object so you can read/set state
    return {
        Frame = frame,
        SetValue = function(_, val)
            active = val
            updateVisual()
        end,
        GetValue = function()
            return active
        end
    }
end

-- Add Button
function UILib._SectionMethods:AddButton(config)
    self._elementOrder = self._elementOrder + 1
    local text = config.Text or "Button"
    local color = config.Color or Color3.fromRGB(60, 80, 180)
    local callback = config.Callback or function() end
    local order = config.Order or self._elementOrder
    
    local btn = Instance.new("TextButton", self.Frame)
    btn.BackgroundColor3 = color
    btn.BorderSizePixel = 0
    btn.Size = UDim2.new(1, 0, 0, 40)
    btn.Font = Enum.Font.GothamBold
    btn.Text = text
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.TextSize = 14
    btn.AutoButtonColor = false
    btn.LayoutOrder = order
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    local gradient = Instance.new("UIGradient", btn)
    gradient.Transparency = NumberSequence.new{
        NumberSequenceKeypoint.new(0, 0),
        NumberSequenceKeypoint.new(1, 0.3)
    }
    gradient.Rotation = 90
    
    btn.MouseButton1Click:Connect(function()
        callback(btn)
    end)
    
    return btn
end

-- Add Label (updateable)
function UILib._SectionMethods:AddLabel(config)
    self._elementOrder = self._elementOrder + 1
    local text = config.Text or ""
    local order = config.Order or self._elementOrder
    
    local label = Instance.new("TextLabel", self.Frame)
    label.BackgroundColor3 = Color3.fromRGB(35, 35, 48)
    label.BorderSizePixel = 0
    label.Size = UDim2.new(1, 0, 0, config.Height or 30)
    label.Font = Enum.Font.GothamSemibold
    label.Text = text
    label.TextColor3 = config.TextColor or Color3.fromRGB(150, 150, 170)
    label.TextSize = config.TextSize or 12
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextWrapped = true
    label.LayoutOrder = order
    Instance.new("UICorner", label).CornerRadius = UDim.new(0, 8)
    
    local padding = Instance.new("UIPadding", label)
    padding.PaddingLeft = UDim.new(0, 12)
    padding.PaddingRight = UDim.new(0, 10)
    if (config.Height or 30) > 40 then
        padding.PaddingTop = UDim.new(0, 8)
    end
    
    return label
end

-- Add Note (inside section)
function UILib._SectionMethods:AddNote(config)
    self._elementOrder = self._elementOrder + 1
    local text = config.Text or ""
    local order = config.Order or self._elementOrder
    
    local noteFrame = Instance.new("Frame", self.Frame)
    noteFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    noteFrame.BorderSizePixel = 0
    noteFrame.Size = UDim2.new(1, 0, 0, 0)
    noteFrame.AutomaticSize = Enum.AutomaticSize.Y
    noteFrame.LayoutOrder = order
    Instance.new("UICorner", noteFrame).CornerRadius = UDim.new(0, 8)
    
    local noteText = Instance.new("TextLabel", noteFrame)
    noteText.BackgroundTransparency = 1
    noteText.Size = UDim2.new(1, -20, 0, 0)
    noteText.AutomaticSize = Enum.AutomaticSize.Y
    noteText.Position = UDim2.new(0, 10, 0, 8)
    noteText.Font = Enum.Font.Gotham
    noteText.Text = text
    noteText.TextColor3 = Color3.fromRGB(150, 180, 255)
    noteText.TextSize = 11
    noteText.TextWrapped = true
    noteText.TextXAlignment = Enum.TextXAlignment.Left
    
    Instance.new("UIPadding", noteFrame).PaddingBottom = UDim.new(0, 10)
    
    return noteText
end

-- Add Feature List Item
function UILib._SectionMethods:AddFeature(config)
    self._elementOrder = self._elementOrder + 1
    local icon = config.Icon or "âœ¨"
    local text = config.Text or "Feature"
    local color = config.Color or Color3.fromRGB(100, 200, 255)
    local order = config.Order or self._elementOrder
    
    local frame = Instance.new("Frame", self.Frame)
    frame.BackgroundColor3 = Color3.fromRGB(35, 35, 48)
    frame.BorderSizePixel = 0
    frame.Size = UDim2.new(1, 0, 0, 36)
    frame.LayoutOrder = order
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)
    
    -- Color indicator bar
    local indicator = Instance.new("Frame", frame)
    indicator.BackgroundColor3 = color
    indicator.BorderSizePixel = 0
    indicator.Size = UDim2.new(0, 3, 0.6, 0)
    indicator.Position = UDim2.new(0, 0, 0.2, 0)
    Instance.new("UICorner", indicator).CornerRadius = UDim.new(0, 2)
    
    local label = Instance.new("TextLabel", frame)
    label.BackgroundTransparency = 1
    label.Position = UDim2.new(0, 12, 0, 0)
    label.Size = UDim2.new(1, -20, 1, 0)
    label.Font = Enum.Font.GothamSemibold
    label.Text = icon .. "  " .. text
    label.TextColor3 = Color3.fromRGB(190, 190, 210)
    label.TextSize = 12
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    return frame
end

-- Add Horizontal Button Grid (for seed selectors etc)
function UILib._SectionMethods:AddButtonGrid(config)
    self._elementOrder = self._elementOrder + 1
    local items = config.Items or {} -- {name, icon, color, data}
    local callback = config.Callback or function() end
    local order = config.Order or self._elementOrder
    local selected = config.Default or (items[1] and items[1].name)
    
    local gridFrame = Instance.new("Frame", self.Frame)
    gridFrame.BackgroundTransparency = 1
    gridFrame.Size = UDim2.new(1, 0, 0, 55)
    gridFrame.LayoutOrder = order
    
    local gridLayout = Instance.new("UIListLayout", gridFrame)
    gridLayout.FillDirection = Enum.FillDirection.Horizontal
    gridLayout.Padding = UDim.new(0, 6)
    gridLayout.SortOrder = Enum.SortOrder.LayoutOrder
    
    local buttons = {}
    
    for i, item in ipairs(items) do
        local btn = Instance.new("TextButton", gridFrame)
        btn.BackgroundColor3 = (item.name == selected) and (item.color or Color3.fromRGB(60, 80, 180)) or Color3.fromRGB(35, 35, 48)
        btn.BorderSizePixel = 0
        btn.Size = UDim2.new(0, config.ButtonWidth or 80, 0, 50)
        btn.Text = ""
        btn.AutoButtonColor = false
        btn.LayoutOrder = i
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
        
        local iconLabel = Instance.new("TextLabel", btn)
        iconLabel.BackgroundTransparency = 1
        iconLabel.Size = UDim2.new(1, 0, 0, 28)
        iconLabel.Text = item.icon or "ðŸ“¦"
        iconLabel.TextSize = 18
        iconLabel.Font = Enum.Font.GothamBold
        
        local nameLabel = Instance.new("TextLabel", btn)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Position = UDim2.new(0, 0, 0, 28)
        nameLabel.Size = UDim2.new(1, 0, 0, 18)
        nameLabel.Text = item.label or item.name
        nameLabel.TextColor3 = Color3.fromRGB(150, 150, 170)
        nameLabel.TextSize = 9
        nameLabel.Font = Enum.Font.GothamSemibold
        
        buttons[item.name] = btn
        
        btn.MouseButton1Click:Connect(function()
            selected = item.name
            for bName, bBtn in pairs(buttons) do
                local bItem
                for _, it in ipairs(items) do
                    if it.name == bName then bItem = it; break end
                end
                bBtn.BackgroundColor3 = (bName == selected) and (bItem and bItem.color or Color3.fromRGB(60, 80, 180)) or Color3.fromRGB(35, 35, 48)
            end
            callback(item)
        end)
    end
    
    return {
        Frame = gridFrame,
        Buttons = buttons,
        GetSelected = function() return selected end,
        SetSelected = function(_, name)
            selected = name
            for bName, bBtn in pairs(buttons) do
                local bItem
                for _, it in ipairs(items) do
                    if it.name == bName then bItem = it; break end
                end
                bBtn.BackgroundColor3 = (bName == selected) and (bItem and bItem.color or Color3.fromRGB(60, 80, 180)) or Color3.fromRGB(35, 35, 48)
            end
        end
    }
end

-- Add TextBox
function UILib._SectionMethods:AddTextBox(config)
    self._elementOrder = self._elementOrder + 1
    local placeholder = config.Placeholder or "Type here..."
    local default = config.Default or ""
    local callback = config.Callback or function() end
    local order = config.Order or self._elementOrder
    
    local frame = Instance.new("Frame", self.Frame)
    frame.BackgroundColor3 = Color3.fromRGB(35, 35, 48)
    frame.BorderSizePixel = 0
    frame.Size = UDim2.new(1, 0, 0, 42)
    frame.LayoutOrder = order
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)
    
    local textbox = Instance.new("TextBox", frame)
    textbox.BackgroundTransparency = 1
    textbox.Position = UDim2.new(0, 15, 0, 0)
    textbox.Size = UDim2.new(1, -30, 1, 0)
    textbox.Font = Enum.Font.Gotham
    textbox.PlaceholderText = placeholder
    textbox.PlaceholderColor3 = Color3.fromRGB(80, 80, 100)
    textbox.Text = default
    textbox.TextColor3 = Color3.new(1, 1, 1)
    textbox.TextSize = 14
    textbox.TextXAlignment = Enum.TextXAlignment.Left
    
    textbox.FocusLost:Connect(function()
        callback(textbox.Text)
    end)
    
    return textbox
end

-- Add Quantity Selector (preset buttons)
function UILib._SectionMethods:AddQuantitySelector(config)
    self._elementOrder = self._elementOrder + 1
    local amounts = config.Amounts or {1, 5, 10, 50, 100}
    local default = config.Default or amounts[3] or 10
    local callback = config.Callback or function() end
    local order = config.Order or self._elementOrder
    
    local gridFrame = Instance.new("Frame", self.Frame)
    gridFrame.BackgroundTransparency = 1
    gridFrame.Size = UDim2.new(1, 0, 0, 38)
    gridFrame.LayoutOrder = order
    
    local gridLayout = Instance.new("UIListLayout", gridFrame)
    gridLayout.FillDirection = Enum.FillDirection.Horizontal
    gridLayout.Padding = UDim.new(0, 6)
    
    local selected = default
    local buttons = {}
    
    for _, amt in ipairs(amounts) do
        local btn = Instance.new("TextButton", gridFrame)
        btn.BackgroundColor3 = (amt == default) and Color3.fromRGB(60, 160, 100) or Color3.fromRGB(45, 50, 75)
        btn.BorderSizePixel = 0
        btn.Size = UDim2.new(0, 65, 0, 34)
        btn.Font = Enum.Font.GothamBold
        btn.Text = "x" .. amt
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.TextSize = 13
        btn.AutoButtonColor = false
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
        
        buttons[amt] = btn
        
        btn.MouseButton1Click:Connect(function()
            selected = amt
            for a, b in pairs(buttons) do
                b.BackgroundColor3 = (a == amt) and Color3.fromRGB(60, 160, 100) or Color3.fromRGB(45, 50, 75)
            end
            callback(amt)
        end)
    end
    
    return {
        Frame = gridFrame,
        GetValue = function() return selected end
    }
end

return UILib
